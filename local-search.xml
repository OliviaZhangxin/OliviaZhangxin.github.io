<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>磁盘IO性能分析</title>
    <link href="/2024/02/19/%E7%A3%81%E7%9B%98IO%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/"/>
    <url>/2024/02/19/%E7%A3%81%E7%9B%98IO%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="磁盘性能指标"><a href="#磁盘性能指标" class="headerlink" title="磁盘性能指标"></a>磁盘性能指标</h2><ul><li>使用率：<br>磁盘处理I&#x2F;O的时间百分比。过高的使用率，比如超过80%，通常意味着已经达到了磁盘I&#x2F;O瓶颈；</li><li>饱和度：<br>指磁盘处理I&#x2F;O的繁忙程度。过高的饱和度，意味着磁盘存在严重性能瓶颈。当饱和度为100%，磁盘无法接受新的I&#x2F;O请求；</li><li>IOPS:<br>每秒的IO请求数；</li><li>吞吐量：<br>每秒的I&#x2F;O请求大小，即每秒磁盘I&#x2F;O的流量，磁盘写入加上读出数据的大小，单位为bps;</li><li>响应时间：<br>指I&#x2F;O请求从发出到收到响应的间隔时间。</li></ul><h2 id="IOPS和吞吐量的关系"><a href="#IOPS和吞吐量的关系" class="headerlink" title="IOPS和吞吐量的关系"></a>IOPS和吞吐量的关系</h2><h2 id="常用的观测IO性能指标的命令"><a href="#常用的观测IO性能指标的命令" class="headerlink" title="常用的观测IO性能指标的命令"></a>常用的观测IO性能指标的命令</h2><h3 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h3><p>iostat，对磁盘的操作活动进行监视，并且会汇报出CPU的使用情况。但也有一个缺点，不能对某个进程深入分析，仅能监视系统的整体情况。</p><h4 id="CPU属性值说明"><a href="#CPU属性值说明" class="headerlink" title="CPU属性值说明"></a>CPU属性值说明</h4><ul><li><strong>%user：</strong> CPU处在用户模式下的时间百分比</li><li><strong>%nice：</strong> CPU处在带NICE值的用户模式下的时间百分比</li><li><strong>%system：</strong> CPU处在系统模式下的时间百分比</li><li><strong>%iowait：</strong> CPU等待输入输出完成时间的百分比</li><li><strong>%steal：</strong> 管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比</li><li><strong>%idle：</strong> CPU空闲时间百分比</li></ul><h4 id="磁盘属性值说明"><a href="#磁盘属性值说明" class="headerlink" title="磁盘属性值说明"></a>磁盘属性值说明</h4><ul><li><strong>rrqm&#x2F;s:</strong> 每秒进行 merge 的读操作数目。即 rmerge&#x2F;s</li><li><strong>wrqm&#x2F;s:</strong> 每秒进行 merge 的写操作数目。即 wmerge&#x2F;s</li><li><strong>r&#x2F;s:</strong> 每秒完成的读 I&#x2F;O 设备次数。即 rio&#x2F;s</li><li><strong>w&#x2F;s:</strong> 每秒完成的写 I&#x2F;O 设备次数。即 wio&#x2F;s</li><li><strong>rkB&#x2F;s:</strong> 每秒读K字节数。是 rsect&#x2F;s 的一半，因为每扇区大小为512字节。</li><li><strong>wkB&#x2F;s:</strong> 每秒写K字节数。是 wsect&#x2F;s 的一半</li><li><strong>avgrq-sz:</strong> 平均每次设备I&#x2F;O操作的数据大小 (扇区)</li><li><strong>avgqu-sz:</strong> 平均I&#x2F;O队列长度</li><li><strong>rsec&#x2F;s:</strong> 每秒读扇区数。即 rsect&#x2F;s</li><li><strong>wsec&#x2F;s:</strong> 每秒写扇区数。即 wsect&#x2F;s</li><li><strong>r_await:</strong> 每个读操作平均所需的时间，不仅包括硬盘设备读操作的时间，还包括了在kernel队列中等待的时间</li><li><strong>w_await:</strong> 每个写操作平均所需的时间，不仅包括硬盘设备写操作的时间，还包括了在kernel队列中等待的时间</li><li><strong>await:</strong> 平均每次设备I&#x2F;O操作的等待时间 (毫秒)</li><li><strong>svctm:</strong> 平均每次设备I&#x2F;O操作的服务时间 (毫秒)</li><li><strong>%util:</strong> 一秒中有百分之多少的时间用于 I&#x2F;O 操作，即被io消耗的cpu百分比</li></ul><h3 id="pidstat"><a href="#pidstat" class="headerlink" title="pidstat"></a>pidstat</h3><h4 id="属性值说明"><a href="#属性值说明" class="headerlink" title="属性值说明"></a>属性值说明</h4><ul><li>%usr：进程在用户空间占用cpu的百分比</li><li>%system：进程在内核空间占用cpu的百分比</li><li>%guest：进程在虚拟机占用cpu的百分比</li><li>%CPU：进程占用cpu的百分比</li><li>CPU：处理进程的cpu编号</li><li>Command：当前进程对应的命令</li></ul><p><strong>pidstat -r -p 29468 1 4</strong>（指定PID为29468的进程内存使用情况，每秒展示一次，展示四次！ 也可以直接pidstat -r，是全部进程的内存使用情况！）</p><ul><li>Minflt&#x2F;s：任务每秒发生的次要错误，不需要从磁盘中加载页</li><li>Majflt&#x2F;s：任务每秒发生的主要错误，需要从磁盘中加载页</li><li>VSZ：虚拟地址大小，虚拟内存的使用KB</li><li>RSS：常驻集合大小，非交换区内存的使用KB</li><li>Command：task命令名</li></ul><p><strong>pidstat -d</strong> 显示各个进程IO的使用情况</p><ul><li>PID：进程ID</li><li>kB_rd&#x2F;s：每秒从磁盘读取的KB</li><li>kB_wr&#x2F;s：每秒写入磁盘KB</li><li>kB_ccwr&#x2F;s：任务取消的写入磁盘的KB。当任务截断脏的pagecache的时候会发生</li><li>COMMAND：task的命令名</li></ul><h4 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h4><ul><li>-p：指定进程号</li><li>-r：显示各个进程的内存使用情况</li><li>-d：显示各个进程的IO使用情况</li><li>-w：显示进程的上下文切换情况</li></ul>]]></content>
    
    
    <categories>
      
      <category>性能测试</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>测试基础</title>
    <link href="/2024/02/07/%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/"/>
    <url>/2024/02/07/%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>测试理论</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
